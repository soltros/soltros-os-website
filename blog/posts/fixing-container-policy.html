<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Fixing Container Policy Issues in Soltros OS - Immutable Linux for Gaming and Development</title>
  <meta name="description" content="How I fixed signature verification issues in Soltros OS and ensured Distrobox compatibility">
  <style>
    :root{
      --bg:#0b0f14;
      --card:#11161d;
      --surface:#0e1319;
      --text:#e8eef4;
      --muted:#a7b5c4;
      --low:#8ea0b4;
      --accent:#3ea6ff;
      --border:#1b2633;
      --ok:#1ad1a5;
      --radius:16px;
      --shadow:0 10px 30px rgba(0,0,0,.35);
      --w:1160px;
    }
    *{box-sizing:border-box}
    html,body{
      margin:0;
      background:linear-gradient(180deg,var(--bg),#0a0f14 60%,#090e13);
      color:var(--text);
      font:16px/1.6 ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Inter,Helvetica,Arial
    }
    a{color:var(--accent);text-decoration:none}
    .wrap{max-width:var(--w);margin:0 auto;padding:0 20px}
    header{display:flex;align-items:center;gap:16px;padding:20px 0}
    header img{width:44px;height:44px;border-radius:12px}
    header .name{font-weight:700}
    
    /* Post-specific styles */
    .back-link{
      display:inline-block;
      color:var(--muted);
      margin:20px 0 10px;
      font-size:.95rem
    }
    .back-link:hover{color:var(--accent)}
    
    article{max-width:720px;margin:0 auto;padding:20px}
    .post-header{margin-bottom:32px}
    .post-header h1{font-size:2.5rem;line-height:1.2;margin:0 0 16px}
    .post-meta{
      color:var(--low);
      font-size:.95rem;
      display:flex;
      gap:12px;
      align-items:center;
      margin-bottom:20px
    }
    .tag{
      display:inline-block;
      border:1px solid var(--border);
      border-radius:999px;
      padding:4px 10px;
      background:#0e141b;
      color:#cfe6ff;
      font-size:.85rem;
      margin-right:6px
    }
    
    .post-content{color:var(--text);line-height:1.8}
    .post-content h2{margin:40px 0 16px;color:var(--text);font-size:1.75rem}
    .post-content h3{margin:32px 0 12px;color:var(--text);font-size:1.35rem}
    .post-content p{margin:16px 0;color:var(--muted)}
    .post-content ul, .post-content ol{margin:16px 0;padding-left:24px;color:var(--muted)}
    .post-content li{margin:8px 0}
    .post-content code{
      background:var(--surface);
      padding:3px 8px;
      border-radius:4px;
      font-size:.9em;
      color:var(--ok)
    }
    .post-content pre{
      background:var(--surface);
      border:1px solid var(--border);
      border-radius:12px;
      padding:16px;
      overflow-x:auto;
      margin:20px 0
    }
    .post-content pre code{
      background:none;
      padding:0;
      color:var(--text)
    }
    .post-content blockquote{
      border-left:3px solid var(--accent);
      padding-left:20px;
      margin:24px 0;
      color:var(--muted);
      font-style:italic
    }
    .post-content img{
      max-width:100%;
      height:auto;
      border-radius:12px;
      margin:24px 0
    }
    .post-content a{color:var(--accent);text-decoration:underline}
    .post-content a:hover{color:#5bb8ff}
    
    footer{border-top:1px solid var(--border);background:var(--surface);margin-top:60px}
    .foot{max-width:var(--w);margin:0 auto;padding:16px 20px;color:#9db0c4;font-size:.92rem;text-align:center}
    
    @media (max-width:980px){
      .post-header h1{font-size:2rem}
      article{padding:20px 10px}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <img src="../../server-desktop_combined.png" alt="Logo">
      <div class="name">Soltros OS</div>
    </header>
  </div>

  <div class="wrap">
    <a href="../index.html" class="back-link">← Back to all posts</a>
  </div>

  <article>
    <div class="post-header">
      <h1>Fixing Container Policy Issues in Soltros OS</h1>
      <div class="post-meta">
        <span>October 22, 2025</span>
        <span>•</span>
        <span>4 min read</span>
      </div>
      <div>
        <span class="tag">Update</span>
        <span class="tag">Containers</span>
        <span class="tag">Security</span>
      </div>
    </div>

    <div class="post-content">
      <p>
        I recently discovered an issue with container signature verification in Soltros OS. The problem? My <code>policy.json</code> configuration wasn't keeping up with the growing family of image variants. If you've been hitting issues with rpm-ostree or Distrobox, this is why—and here's how I fixed it.
      </p>

      <h2>What Went Wrong</h2>
      <p>
        Soltros started with a single image: <code>soltros-os</code>. My <code>policy.json</code> was configured to verify signatures for that specific image path. Simple enough.
      </p>
      <p>
        Then I added more variants: <code>soltros-os_lts</code>, <code>soltros-lts_cosmic</code>, <code>soltros-unstable_cosmic</code>, and GNOME editions. Each new variant got its own image path. But the policy file? Still only knew about the original image.
      </p>
      <p>
        The result: rpm-ostree was pulling images with <code>ostree-unverified-registry</code> in the status output. Signature verification wasn't happening. And for some users, Distrobox was getting blocked by overly strict policies that shouldn't have applied to third-party container images.
      </p>

      <h2>The Fix</h2>
      <p>
        I've updated <code>policy.json</code> to properly handle all Soltros image variants while keeping Distrobox and other container tools working smoothly. The new configuration does three things:
      </p>
      <ul>
        <li>Verifies signatures for all Soltros OS images using sigstore</li>
        <li>Allows unrestricted access to third-party container images (Docker Hub, Quay, etc.)</li>
        <li>Keeps the docker-daemon transport open for local container operations</li>
      </ul>

      <h3>For Users: Emergency Fix Script</h3>
      <p>
        If you're experiencing issues right now, I've released an emergency fix script. Download and run it:
      </p>

      <pre><code>curl -sSL https://raw.githubusercontent.com/soltros/Soltros-OS-Components/refs/heads/master/emergency-policy-fix.sh -o fix-policy.sh
chmod +x fix-policy.sh
sudo ./fix-policy.sh</code></pre>

      <p>
        The script backs up your existing configuration, installs the corrected policy, and verifies everything is working. It's safe to run—if anything goes wrong, it automatically rolls back to your backup.
      </p>

      <h3>What Changed in the Build</h3>
      <p>
        Future Soltros images will ship with the correct <code>policy.json</code> from the start. I've updated my Containerfile to include signature verification policies for all current image variants:
      </p>
      <ul>
        <li>soltros-os (base)</li>
        <li>soltros-os_lts</li>
        <li>soltros-lts_cosmic</li>
        <li>soltros-unstable_cosmic</li>
        <li>soltros-os-lts_gnome</li>
        <li>soltros-os-unstable_gnome</li>
      </ul>

      <p>
        Each image gets verified with the Soltros public key at <code>/etc/pki/containers/soltros.pub</code>. Everything else—Fedora base images, Ubuntu containers for Distrobox, whatever you need—works without verification requirements.
      </p>

      <h2>Why This Matters</h2>
      <p>
        Container signature verification isn't just security theater. When it works correctly, it ensures the OS image you're running actually came from me and hasn't been tampered with. But when it's misconfigured, it either fails silently (bad) or blocks legitimate use cases (also bad).
      </p>
      <p>
        The balance I'm aiming for: verify what needs verification (Soltros system images), stay out of the way for everything else (your development containers, Distrobox environments, whatever else you're running).
      </p>

      <h2>Moving Forward</h2>
      <p>
        This is part of the learning process with an immutable OS. Policy files need to evolve alongside the distribution. I'm still figuring out the best way to handle this—maybe there's a better approach than manually listing every image variant.
      </p>
      <p>
        If you hit issues after running the fix script, or if you're seeing something I missed, let me know. I'm on <a href="https://github.com/soltros/soltros-os">GitHub</a> and responsive to issues.
      </p>

      <p>
        Soltros OS is still early. Problems like this are going to happen. But I'm committed to fixing them quickly and keeping the system reliable for the people using it.
      </p>
    </div>
  </article>

  <footer>
    <div class="foot">
      © <span id="year"></span> Derrik • <a href="../index.html">Blog</a> • <a href="mailto:soltros@proton.me">Contact</a>
    </div>
  </footer>

  <script>
    document.getElementById('year').textContent = new Date().getFullYear();
  </script>
</body>
</html>